\documentclass[a4j,titlepage]{jarticle}
\usepackage[dvipdfmx]{graphicx}
\usepackage{ascmac}
\usepackage{url}

\title{居酒屋検索システム\\
外部設計書\\
第0版}
\author{株式会社Spirytus}
\date{\today}

\begin{document}
\maketitle
\tableofcontents

\section{機能概要}
\subsection{お酒検索機能}
検索項目
\begin{enumerate}
\item お酒の銘柄
\item お酒の種類
\item お酒の味
\item アルコール度数
\end{enumerate}
お酒検索機能では、上記の検索項目の条件を満たしたお酒の一覧を表示する機能です。
お酒の詳細情報画面から、そのお酒を取り扱っている店舗の一覧を表示します。

\subsection{店舗検索機能}
検索項目
\begin{enumerate}
\item 取り扱っているお酒
\item 取り扱っている郷土料理
\item 取り扱っている食材
\item 観光地の近辺
\item 店舗名
\item 住所
\item 平均予算
\item 宴会が行なえるかどうかの有無
\end{enumerate}
店舗検索機能では、上記の検索項目の条件を満たした店舗の一覧を表示する機能です。

\subsection{店舗登録機能}
店舗側は端末を使用して店舗登録申請フォームにアクセスし、必要情報を入力し申請を行います。この申請に対しシステム側で店舗の広告を行うか判断します。広告を行うと判断された場合、e-mailアドレス、パスワードをデータベースに登録します。
このe-mailアドレス、パスワードを使用しログインすることでページ編集画面にアクセスすることができ、この画面で店舗情報の編集を行います。

\subsubsection{店舗の申請フォーム}
入力：e-mailアドレス
出力：メール送信
処理：登録ページのURLが記載されたメールを店舗側に送信します。店舗側はURLにアクセスし新規の登録を行い、運営側で登録された情報に対し審査を行います。登録された情報に不備等がなければそのまま登録を行います。不備等がある場合、店舗に対してメールや電話で問い合わせを行います。

\subsubsection{店側のログイン機能}
入力：e-mailアドレス、パスワード
出力：ログイン成功ならば店舗個別ページを出力
処理：入力情報とデータベースを照合しログインの合否を判定します。ログインに成功した場合、店舗情報の編集画面に遷移します。


\subsection{お酒のレビュー}
お酒の詳細情報にお酒のレビュー項目を設けています。
内容としては、ユーザIDを入力し、その選んだお酒の味を数値でレビューします。
また、コメント欄を設けお酒に対する味の感想やコメントを書いてもらいます。

\subsection{店舗のレビュー}
店舗の詳細情報に店舗のレビュー項目を設けています。
内容としては、ユーザIDを入力し、その店舗全体の雰囲気の良し悪しを数値で行います。
また、コメント欄を設け店舗に来た感想やコメントを書いてもらいます。

\subsection{店舗側の店舗情報登録機能}
店舗情報内容
\begin{enumerate}
\item 店舗名
\item 店舗の画像
\item 営業時間(営業日の営業時間や定休日)
\item 店舗の住所
\item 交友手段(最寄の駅から車・徒歩等での所要時間)
\item 店舗の予約用電話番号(電話の際の注意事項も付け加える)
\item 座席数(個室数、カウンター数、宴会場の収容人数)
\item 喫煙席の有無
\item コースメニューの内容と値段
\item 店舗のHPやブログのURLを表示
\item メニューと価格
\item 店のアピール
\end{enumerate}

店舗情報の登録機能では店側が店舗の決められている営業時間や全体のメニュー、その他の情報を登録する機能です。
\section{データ定義}
本章では、データベースで管理するデータについて定義します。
データベースのテーブルは、表\ref{tables}に示すテーブル群から構成されます。
また、これらのテーブル間のつながりを示したER図を別添ファイル「ER図.pdf」に、
各テーブルの定義を別添ファイル「データ定義書.pdf」に示します。
​
\begin{table}[!htbp]
\caption{データテーブル一覧}
\label{tables}
\begin{center}
\begin{tabular}{|l|l|l|}\hline
テーブル名 & 内容 & 詳細\\\hline\hline
liquors & お酒 & お酒に関する情報\\\hline
stores & 店舗 & 店舗に関する情報\\\hline
dishes & 料理 & 料理に関する情報\\\hline
ingredients & 食材 & 食材に関する情報\\\hline
resorts & 観光地 & 観光地に関する情報\\\hline
alcoholics & 酒類 & 酒類に関する情報\\\hline
brewers & 酒造 & 酒造に関する情報\\\hline
details & 詳細 & お酒、店舗、郷土料理、観光地の詳細情報\\\hline
liquor\_text\_reviews & お酒の文章レビュー & お酒の文章レビューに関する情報\\\hline
liquor\_number\_reviews & お酒の数値レビュー & お酒の数値レビューに関する情報\\\hline
liquor\_averages & お酒の数値レビューの平均 & お酒の数値レビューの平均に関する情報\\\hline
store\_text\_reviews & 店舗の文章レビュー & 店舗の文章レビューに関する情報\\\hline
store\_number\_reviews & 店舗の数値レビュー & 店舗の数値レビューに関する情報\\\hline
store\_averages & 店舗の数値レビューの平均 & 店舗の数値レビューの平均に関する情報\\\hline
users & ユーザ & ユーザに関する情報\\\hline
store\_users & 店舗ユーザ & 店舗ユーザに関する情報\\\hline
store\_liquors & 店舗にあるお酒 & 店舗とお酒を関連付ける情報\\\hline
store\_dishes & 店舗にある料理 & 店舗と料理を関連付ける情報\\\hline
desh\_ingredients & 料理の食材 & 料理と食材を関連付ける情報\\\hline
liquor\_details & お酒の詳細 & お酒と詳細を関連付ける情報\\\hline
store\_details & 店舗の詳細 & 店舗と詳細を関連付ける情報\\\hline
local\_dishes\_details & 郷土料理の詳細 & 郷土料理と詳細を関連付ける情報\\\hline
resort\_details & 観光地の詳細 & 観光地と詳細を関連付ける情報\\\hline
\end{tabular}
\end{center}
\end{table}

\section{ユーザインタフェース設計}
詳細は別紙で
\section{ネットワーク設計}
本システムは図\ref{net}のようにHTTPを用いてクライアントとサーバのやり取りを行います。
\begin{enumerate}
  \item クライアント側がサーバ側に「リクエスト」を送信します
  \item サーバ側でリクエストの解析・処理してリクエストの答えを作ります
  \item サーバ側がクライアント側に「レスポンス」を返します
\end{enumerate}
\begin{figure}[h]
  \begin{center}
    \includegraphics[width=0.8\linewidth]{net.eps}
    \caption{クライアントとサーバのやり取り}
    \label{net}
  \end{center}
\end{figure}

\section{セキュリティ対策}
\subsection{不正アクセス対策}
ファイアウォールの導入により、不正アクセスが行われることを防ぎます。
また、侵入検知システム（IDS）を導入することで、
不正アクセスの兆候を検知し、早めの対応を行えるようにします。
\subsection{暗号化通信}
サーバ・クライアント間の通信は全てSSL通信を利用します。
これにより、通信内容の盗聴されることで情報が外部に漏洩することを防ぎます。
また、ユーザからの信頼性を向上させるために、SSL証明書を購入およびインストールします。
\subsection{ユーザ認証}
このシステムでは、店舗情報の登録および更新やユーザによるレビュー投稿機能を、
その権限のないユーザが行うことを防ぐために、ユーザ認証を行います。
店舗関係者とユーザのログイン時は、登録されたe-mailアドレスとパスワードの組み合わせにより認証を行います。
また、パスワードをハッシュ化してからデータベースに保存することで、
データベース内の情報が外部に漏洩してもパスワードが第三者に知られることを防ぎます。

\section{障害対策}
\subsection{ソフトウェアの障害対策}
データベースの障害対策として、メインで使用するHDD以外のHDDに、
データベースのバックアップを保存します。
毎日深夜0時に自動でバックアップを行い、
障害発生時にはこのバックアップデータからリストアし、復元します。
\subsection{許容停止時間}
障害発生によりシステムが機能しない場合、
直ちに再稼働のための手続きを行います。
システムが停止してから再稼働までの許容停止時間は48時間とします。

\section{ソフトウェア品質}
システムに組み込むプログラムは全て、テストを通過したもののみを扱います。
これにより常に一定の品質を確保します。
システムにバグが発見された場合には、直ちに修正しシステムをアップデートし、
必要に応じてテストの内容を更新します。




\end{document}
